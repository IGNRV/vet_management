<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>

    <!-- ===== Search ===== -->
    <record id="deworming_search_view" model="ir.ui.view">
      <field name="name">animal.deworming.search.view</field>
      <field name="model">animal.deworming</field>
      <field name="arch" type="xml">
        <search string="Buscar registros de desparasitación">
          <field name="animal_id" string="Animal"/>
          <field name="owner_id" string="Dueño"/>
          <field name="specie_id" string="Especie"/>
          <field name="dewormer_id" string="Desparasitante"/>
          <field name="date" string="Fecha"/>
          <field name="next_date" string="Próxima desparasitación"/>
          <field name="route" string="Vía"/>
          <field name="doctor" string="Dr/Dra"/>
          <field name="quantity_units" string="Cantidad (unidades)"/>
          <field name="lot_number" string="Lote"/>
          <field name="lot_expiration" string="Vencimiento"/>
          <field name="notes" string="Notas/Observaciones"/>

          <group expand="0" string="Agrupar por">
            <filter name="grp_animal" string="Animal" context="{'group_by':'animal_id'}"/>
            <filter name="grp_owner" string="Dueño" context="{'group_by':'owner_id'}"/>
            <filter name="grp_specie" string="Especie" context="{'group_by':'specie_id'}"/>
            <filter name="grp_dewormer" string="Desparasitante" context="{'group_by':'dewormer_id'}"/>
            <filter name="grp_route" string="Vía" context="{'group_by':'route'}"/>
            <filter name="grp_doctor" string="Dr/Dra" context="{'group_by':'doctor'}"/>
            <filter name="grp_date" string="Fecha (mes)" context="{'group_by':'date:month'}"/>
          </group>
        </search>
      </field>
    </record>

    <!-- ===== Tree ===== -->
    <record id="deworming_tree_view" model="ir.ui.view">
      <field name="name">animal.deworming.tree.view</field>
      <field name="model">animal.deworming</field>
      <field name="arch" type="xml">
        <tree string="Registros de Desparasitaciones">
          <field name="date" string="Fecha"/>
          <field name="animal_id" string="Animal"/>
          <field name="owner_id" string="Dueño"/>
          <field name="specie_id" string="Especie"/>
          <field name="dewormer_id" string="Desparasitante"/>
          <field name="quantity_units"/>
          <field name="consume_stock"/>
          <field name="route" string="Vía"/>
          <field name="doctor" string="Dr/Dra"/>
          <field name="next_date" string="Próx. desparasitación"/>
          <field name="lot_number"/>
          <field name="lot_expiration"/>
          <field name="notes" string="Notas"/>
        </tree>
      </field>
    </record>

    <!-- ===== Form ===== -->
    <record id="deworming_form_view" model="ir.ui.view">
      <field name="name">animal.deworming.form.view</field>
      <field name="model">animal.deworming</field>
      <field name="arch" type="xml">
        <form string="Registro de Desparasitación">
          <sheet>
            <group>
              <group string="Datos del Animal">
                <field name="animal_id" required="1"/>
                <field name="owner_id" readonly="1"/>
                <field name="specie_id" readonly="1"/>
              </group>
              <group string="Desparasitación">
                <field name="dewormer_id" required="1"/>
                <field name="quantity_units" required="1"/>
                <field name="consume_stock"/>
                <field name="date" required="1"/>
                <field name="route"/>
                <field name="doctor" string="Dr/Dra" placeholder="Nombre del profesional"/>
                <field name="next_date" string="Próxima desparasitación"/>
              </group>
            </group>
            <group string="Lote / Observaciones">
              <field name="lot_number"/>
              <field name="lot_expiration"/>
              <field name="notes" placeholder="Notas u observaciones clínicas..."/>
            </group>
          </sheet>

          <div class="oe_chatter">
            <field widget="mail_thread" name="message_ids"/>
            <field widget="mail_activity" name="activity_ids"/>
          </div>
        </form>
      </field>
    </record>

    <!-- ===== Action (listado independiente) ===== -->
    <record id="deworming_action" model="ir.actions.act_window">
      <field name="name">Registros de Desparasitaciones</field>
      <field name="res_model">animal.deworming</field>
      <field name="view_mode">search,tree,form,kanban</field>
    </record>

  </data>
</odoo>
